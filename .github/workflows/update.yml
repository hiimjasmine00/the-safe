name: Update The Safe
on:
    schedule:
        - cron: "0 5 * * *"
    workflow_dispatch:

jobs:
    update:
        name: Update The Safe
        runs-on: ubuntu-latest
        steps:
            - name: Checkout repository
              uses: actions/checkout@v4

            - name: Get the date
              id: date
              run: echo "date=$(date +'%Y-%m-%d')" >> $GITHUB_OUTPUT

            # Run update.js
            - name: Run update.js
              run: node update -1 && node update -2 && node update -3 && node gddl

            - uses: stefanzweifel/git-auto-commit-action@v5
              with:
                  commit_message: "Update The Safe (${{ steps.date.outputs.date }})"
